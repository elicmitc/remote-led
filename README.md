TODO: clean code and write documentation. 
